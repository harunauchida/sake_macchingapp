<h1>アカウント情報</h1>

<%= form_with(model: @user, url: user_path(@user), method: :patch, local: true, class: "user-form") do |f| %>
  <% if flash[:error] %>
    <div class="alert alert-danger"><%= flash[:error] %></div>
  <% end %>

  <% if flash[:success] %>
    <div class="alert alert-success"><%= flash[:success] %></div>
  <% end %>

  <!-- 名前 -->
  <div class="form-group">
    <%= f.label :name, "名前" %>
    <%= f.text_field :name, class: "form-control" %>
  </div>

  <!-- メールアドレス -->
  <div class="form-group">
    <%= f.label :email, "メールアドレス" %>
    <%= f.email_field :email, class: "form-control" %>
  </div>

  <!-- パスワード -->
  <div class="form-group">
    <%= f.label :password, "新しいパスワード（変更しない場合は空欄）" %>
    <%= f.password_field :password, class: "form-control", autocomplete: "off" %>
  </div>

  <!-- パスワード確認 -->
  <div class="form-group">
    <%= f.label :password_confirmation, "パスワード確認" %>
    <%= f.password_field :password_confirmation, class: "form-control", autocomplete: "off" %>
  </div>

  <!-- プロフィール文 -->
  <div class="form-group">
    <%= f.label :bio, "プロフィール" %>
    <%= f.text_area :bio, class: "form-control", rows: 3 %>
  </div>

  <!-- アイコン画像 -->
  <div class="form-group">
    <%= f.label :icon, "アイコン画像" %>
    <%= f.file_field :icon, class: "form-control" %>

    <%# 現在のアイコン表示（未設定時はデフォルト画像） %>
    <% if @user.icon&.attached? %>
      <div class="current-icon">
        現在のアイコン：
        <%= image_tag @user.icon, class: "user-icon" %>
      </div>
    <% else %>
      <div class="current-icon">
        現在のアイコン：
        <%= image_tag "default_icon.jpg", class: "user-icon" %>
      </div>
    <% end %>
  </div>

  <%= f.submit "更新する", class: "btn btn-primary" %>
<% end %>

<%= link_to "戻る", root_path, class: "btn btn-secondary mt-2" %>
