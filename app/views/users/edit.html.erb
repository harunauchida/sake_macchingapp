<h1>アカウント情報</h1>

<%= form_with(model: @user, url: user_path(@user), method: :patch, local: true, class: "user-form") do |f| %>
  
  <% if @user.guest? %>
    <div class="alert alert-info">
      ゲストユーザーは変更できません
    </div>
  <% end %>

  <!-- 名前 -->
  <div class="form-group">
    <%= f.label :name, "名前" %>
    <%= f.text_field :name, class: "form-control", readonly: @user.guest? %>
  </div>

  <!-- メールアドレス -->
  <div class="form-group">
    <%= f.label :email, "メールアドレス" %>
    <%= f.email_field :email, class: "form-control", readonly: @user.guest? %>
  </div>

  <!-- パスワード -->
  <div class="form-group">
    <%= f.label :password, "新しいパスワード（変更しない場合は空欄）" %>
    <%= f.password_field :password, class: "form-control", autocomplete: "off", readonly: @user.guest? %>
  </div>

  <!-- パスワード確認 -->
  <div class="form-group">
    <%= f.label :password_confirmation, "パスワード確認" %>
    <%= f.password_field :password_confirmation, class: "form-control", autocomplete: "off", readonly: @user.guest? %>
  </div>

  <!-- プロフィール文 -->
  <div class="form-group">
    <%= f.label :bio, "プロフィール" %>
    <%= f.text_area :bio, class: "form-control", rows: 3, readonly: @user.guest? %>
  </div>

  <!-- アイコン画像 -->
  <div class="form-group">
    <%= f.label :icon, "アイコン画像" %>
    <%= f.file_field :icon, class: "form-control", disabled: @user.guest? %>

    <div class="current-icon">
      現在のアイコン：
      <%= image_tag @user.icon&.attached? ? @user.icon : "default_icon.jpg", class: "user-icon" %>
    </div>
  </div>

  <% unless @user.guest? %>
    <%= f.submit "更新する", class: "btn btn-primary" %>
  <% end %>
<% end %>

<%= link_to "戻る", root_path, class: "btn btn-secondary mt-2" %>
